import * as _ from 'lodash';

import { MiddlewareModuleInstrumentor } from './MiddlewareModuleInstrumentor';

export class MorganModuleInstrumentor extends MiddlewareModuleInstrumentor {
    constructor() {
        super(
            'morgan'        /* supportedModule */,
            '>=1.6 <1.9'    /* supportedModuleVersions */,
            'logger'        /* name */,
            'Morgan Logger' /* displayName */,
            'morgan'        /* packageName */);
    }

    protected onProxyModule(originalModule, newModule) {
        // NOTE: Accessing the 'default' property of the module will result in a 'deprecated default format' warning.
        //       We need to keep the property on the new module for compatibility purposes so the warning, while annoying, must be ignored.

        _.assign(newModule, originalModule);
    }
}

export default MorganModuleInstrumentor;
