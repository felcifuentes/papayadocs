import { IModuleInstrumentor } from '../IModuleInstrumentor';
import { IModuleInfo } from '../IModuleInfo';
import { IEnableInstrumentationResult } from '../IEnableInstrumentationResult';
import { RedisProxy } from './RedisProxy';

export class RedisModuleInstrumentor implements IModuleInstrumentor {
    public get supportedModules(): { [ moduleName: string ]: string; } {
        return {
            'redis': '>= 2.0.0 < 3.0.0'
        };
    }

    public enableInstrumentation(moduleInfo: IModuleInfo): IEnableInstrumentationResult {
        (new RedisProxy()).proxyModule(moduleInfo.originalModule);

        return {
            isEnabled: true
        };
    }
}
