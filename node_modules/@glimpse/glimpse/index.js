var glimpseAgent = require('@glimpse/glimpse-agent-node'),
    glimpseServer = require('@glimpse/glimpse-server');

var _ = require('lodash');

module.exports = {
    agent: glimpseAgent.agent,
    server: glimpseServer.server,

    init: function init(options) {
        var serverOptions = {};

        if (options && options.server) {
            serverOptions = _.assign({ glimpseLaunchMechanism: options.glimpseLaunchMechanism }, serverOptions, options.server);
        }

        var agentOptions = { server: glimpseServer.server };

        if (options && options.agent) {
            agentOptions = _.assign({ glimpseLaunchMechanism: options.glimpseLaunchMechanism }, agentOptions, options.agent);
        }

        glimpseServer.server.init(serverOptions);
        glimpseAgent.agent.init(agentOptions);
    }
};
